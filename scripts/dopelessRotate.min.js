(function(e){var t="ontouchstart"in document.documentElement;e.fn.tsRotate=function(n){function J(e,t){N.find(e).css(t)}function Z(t,n){var r=0;var i=0;var s=[];e(t).each(function(){var t=e("<img>").attr("src",this).load(function(){r=r+100/n;V=Math.round(X/100*r);e(N).find(".loading_bar_inside").css("width",V);if(Math.round(r)==100){e(N).find(".loading_bg").fadeOut();e(N).find(".round, .zoom").fadeIn();if(h){tt()}}});i++;C.attr("src",this);s.push(t)});C.attr("src",t[u]);st();if(h){var o=N.parent(".dopelessrotate").find(".sethotspot").length;if(o<1){alert("Please add at least one hotspot element (see manual)")}else{d=new Array;N.parent(".dopelessrotate").find(".sethotspot").each(function(t){var n=e(this).attr("href");var r=e(this).attr("posix");var i=e(this).attr("posiy");var s=e(this).attr("title");var u=e(this).text();e(this).remove();d[t]=new Object;d[t]["frame"]=n-1;d[t]["posix"]=r;d[t]["posiy"]=i;d[t]["title"]=s;d[t]["text"]=u;if(t+1==o){N.append('<div class="highlights"><a href="#" class="highlights_but">'+v+"</a></div>");for(var a=0;a<d.length;a++){N.find(".highlights").append('<a class="highlights_item" href="'+a+'">'+d[a].title+"</a>");e(".highlights_item").css({display:"none"})}}})}}}function st(){var e=Math.floor(360/G)*s;var t=e*u;var n=t*Math.PI/180;var r=Math.sin(n);var i=Math.cos(n);var o=_+D*r*-1;var a=_+D*i;J(".pointer",{left:o,top:a})}function ot(e){T.on("mousemove.dragrotate",function(t){if(h){nt()}var n=t.pageX-A.left;var r=n-e;var i=Math.round(S/G)*s;var o=Math.round(r/i);var f=Math.abs(Math.floor((o+a)/G));u=a+o;if(u>=G){u=u-G*f}if(u<0){u=G*f+u}C.attr("src",K[u]);st()});T.on("mouseup.dragrotate",function(){if(h&&p){tt()}a=u;T.off(".dragrotate")})}function ut(t){N.on("touchmove.dragrotatemob",function(n){if(h){nt()}e(document).find(".highlights_item").css({display:"none"});var r=window.event;var i=r.touches[0].pageX-A.left;var o=i-t;var f=Math.round(S/G)*s;var l=Math.round(o/f);var c=Math.abs(Math.floor((l+a)/G));u=a+l;if(u>=G){u=u-G*c}if(u<0){u=G*c+u}C.attr("src",K[u]);st()});N.on("touchend.dragrotatemob",function(e){if(h){tt()}a=u;N.off(".dragrotatemob")})}function at(e,t,n){Y=true;nt();N.find(".highlights").fadeOut();var r=true;N.find(".round").fadeOut();N.find(".zoom").fadeOut();var i=new Image;i.src=Q[u];if(i.complete||i.readystate===4){}else{N.find(".zoomload_bg").fadeIn()}i.onload=function(){zoomHeight=i.height;zoomWidth=i.width;var r=(zoomWidth-S)/-2;var s=(zoomHeight-x)/-2;k.attr("src",Q[u]);k.css({left:r,top:s});C.animate({width:zoomWidth,height:zoomHeight,left:r,top:s},100,"linear",function(){k.animate({width:zoomWidth,height:zoomHeight,left:r,top:s},100,"linear",function(){k.fadeIn(100)})});N.find(".zoomload_bg").fadeOut();N.addClass("zoomout");var o=false;N.on("mousemove.dragpan",function(i){var o=i.pageX-n.left;var u=i.pageY-n.top;var a=(zoomWidth-S)*-1;var f=(zoomHeight-x)*-1;var l=Math.floor(zoomWidth/S);var c=Math.floor(zoomHeight/x);var h=e-o;var p=t-u;var d=r+h*l;var v=s+p*c;var m=false;var g=false;if(d>=0){m=true;e=e-d}if(d<=a){m=true;e=e-d+a}if(v>=0){g=true;t=t-v}if(v<=f){g=true;t=t-v+f}if(!m){k.css("left",d)}if(!g){k.css("top",v)}});T.on("mousedown.zoomof",function(){if(!o){if(h){tt();N.find(".highlights").fadeIn()}N.off(".dragpan");N.off("mousedown.zoomof");C.attr("src",K[u]);C.css({left:0,top:0,width:S,height:x});k.animate({width:S,height:x,left:0,top:0},100,"linear",function(){k.fadeOut(100)});N.find(".round").fadeIn();N.find(".zoom").fadeIn();N.removeClass("zoomout");Y=false}})}}function ft(e,t,n,r,i){var s=window.event;var o=s.touches[0].pageX-n.left;var u=s.touches[0].pageY-n.top;var a=(zoomWidth-S)*-1;var f=(zoomHeight-x)*-1;var l=Math.floor(zoomWidth/S);var c=Math.floor(zoomHeight/x);var h=e-o;var p=t-u;var d=r+h*l*-1;var v=i+p*c*-1;if(d>=0){d=0}if(d<=a){d=a}if(v>=0){v=0}if(v<=f){v=f}k.css("left",d);k.css("top",v);N.on("touchend.zoomendmob",function(){N.off(".mobdragpan");lt=d;ct=v})}function ht(t){Y=true;nt();N.find(".highlights").fadeOut();e(document).find(".highlights_item").css({display:"none"});var n=true;N.find(".round").fadeOut();e(".zoom").fadeOut();var r=new Image;r.src=Q[u];if(r.complete||r.readystate===4){}else{e(N).find(".zoomload_bg").fadeIn()}r.onload=function(){zoomHeight=r.height;zoomWidth=r.width;var n=(zoomWidth-S)/-2;var i=(zoomHeight-x)/-2;k.attr("src",Q[u]);k.css({left:n,top:i});C.animate({width:zoomWidth,height:zoomHeight,left:n,top:i},100,"linear",function(){k.animate({width:zoomWidth,height:zoomHeight,left:n,top:i},100,"linear",function(){k.fadeIn(100)})});N.find(".zoomload_bg").fadeOut();N.addClass("zoomout");var s=false;N.on("touchstart.dragstartmob",function(){if(typeof lt!=="undefined"){n=lt}if(typeof ct!=="undefined"){i=ct}var e=window.event;var r=e.touches[0].pageX-t.left;var s=e.touches[0].pageY-t.top;N.on("touchmove.mobdragpan",function(e){e.preventDefault();ft(r,s,t,n,i)})});N.on("click.zoomofmob",function(){if(!s){if(h){tt();N.find(".highlights").fadeIn()}N.off(".zoomendmob");N.off(".dragstartmob");C.attr("src",K[u]);C.css({left:0,top:0,width:S,height:x});k.animate({width:S,height:x,left:0,top:0},100,"linear",function(){k.fadeOut(100)});e(N).find(".round").fadeIn();e(".zoom").fadeIn();N.removeClass("zoomout");Y=false}})}}var r=e.extend({zoom:true,reverse:false,disablelogo:false,nophp:false,nophpimglist:"",nophpzoomlist:"",startfrom:0,zoomfolder:"zoomimages",pathtophp:"dopelessRotate/scripts/",hotspots:false,hotspotsTitle:"Highlights"},n);var i=r.zoom?'<div class="zoom"></div>':"";var s=r.reverse?-1:1;var o=r.disablelogo?"":'<a id="dopeless_rotate_logo" title="Dopeless Rotate Plugin Home" target="_blank" href="http://www.dopeless-design.de/dopeless-rotate-jquery-plugin-360-degrees-product-viewer.html">Dopeless Rotate</a>';var u=r.startfrom;var a=r.startfrom;var f=r.zoomfolder;var l=r.pathtophp;var c=r.nophp;var h=r.hotspots;var p=true;if(h){var d}var v=r.hotspotsTitle;if(c){var m=r.nophpimglist;var g=r.nophpzoomlist}var y=e(this)[0].src;var b=document.createElement("a");b.href=y;var w=b.pathname+b.search;var E=e(this).attr("id");var S=e(this).attr("width");var x=e(this).attr("height");e(this).wrap('<div class="ts_holder" id="holder_'+E+'"/>');var T=e(document);var N=e("#holder_"+E+"");N.html("<img class='ts_img_view' src='' /><img class='ts_imgzoom_view' src='' /><div class='round'><div class='pointer_object'></div><div class='pointer'></div></div>"+i+"<div class='loading_bg'><div class='loading'><p>loading</p><div class='loading_bar'><div class='loading_bar_inside'></div></div></div></div><div class='zoomload_bg'><div class='zoomload_gif'></div></div></div>"+o);var C=e(N).find(".ts_img_view");var k=e(N).find(".ts_imgzoom_view");var L=e(N).find(".round");var A=N.offset();var O=Math.ceil(S/5);var M=Math.ceil(O/10);var _=O/2-M/2-1;var D=O/2-M;var P=O/2-M*2;var H=(O-P)/2;var B=Math.round((S-220)/2);var j=Math.round((x-20)/2);var F=Math.round(S/100*40);var I=72;var q=Math.round((S-F)/2);var R=Math.round((x-I)/2);var U=Math.round(F/100*80);var z=Math.round((F-U)/2);var W=Math.round(I/100*15);var X=U-4;var V;N.bind("dragstart",function(e){e.preventDefault()});N.children().bind("dragstart",function(e){e.preventDefault()});N.css({width:S,height:x});J(".loading_bg, .zoomload_bg",{width:S,height:x});J(".zoomload_gif",{left:B,top:j});J(".loading",{width:F,height:I,left:q,top:R});J(".loading_bar",{width:U,left:z,bottom:W});J(".round",{width:O,height:O});J(".pointer",{width:M,height:M,left:_,top:_*2});J(".zoom",{top:O+O/10+10,right:(O-30)/2-3});J(".pointer_object",{width:P,height:P,left:H,top:H});N.find(".loading_bg").fadeIn();var K;var Q;var G;var Y;if(!c){e.getJSON(l+"/loadimages.php",{fname:w,zoomdir:f},function(e){K=jQuery.makeArray(e.imagelist);Q=jQuery.makeArray(e.zoomlist);G=K.length;Z(K,G)})}if(c){K=m.split(",");Q=g.split(",");G=K.length;Z(K,G)}if(h){e(document).on("click",".highlights_but",function(e){e.preventDefault()});if(!t){N.find(".ts_img_view").on("click",function(){N.find(".highlights_item").removeClass("active");it()});N.on("mouseenter",".highlights",function(){e(this).find(".highlights_item").css({display:"block"});e(this).on("mouseleave",function(){e(this).find(".highlights_item").css({display:"none"})})});N.on("click",".highlights_item",function(e){e.preventDefault()});N.on("click",".highlights_item:not(.active)",function(){N.find(".highlights_item").removeClass("active");e(this).addClass("active");var t=parseInt(e(this).attr("href"));var n=parseInt(d[t].frame);if(n!=u){nt();et(n,t)}else{it();rt(t)}});N.on("click",".hotspot",function(){var t=parseInt(e(this).attr("id").replace("hs",""));it();rt(t)});N.on("click",".expanded",function(){N.find(".highlights_item").removeClass("active");it()})}if(t){N.on("touchstart",".highlights",function(){e(this).find(".highlights_item").css({display:"block"})});N.on("touchend",".highlights_item",function(e){e.preventDefault()});N.on("touchend",".highlights_itemnot(.active)",function(){N.find(".highlights_item").removeClass("active");e(this).addClass("active");var t=parseInt(e(this).attr("href"));var n=parseInt(d[t].frame);if(n!=u){nt();et(n,t)}else{it();rt(t)}});N.on("touchend",".hotspot",function(){var t=parseInt(e(this).attr("id").replace("hs",""));it();rt(t)});N.on("touchend",".expanded",function(){N.find(".highlights_item").removeClass("active");it()})}function et(e,t){(function n(){if(u>e){u--;C.attr("src",K[u]);if(u==e){a=u;tt(t);st()}else{setTimeout(n,30)}}if(u<e){u++;C.attr("src",K[u]);if(u==e){a=u;tt(t);st()}else{setTimeout(n,30)}}})()}function tt(e){N.find(".expanded").removeClass("expanded").find(".hltitle,.hltext").remove();N.find(".highlights_item").removeClass("active");for(var t=0;t<d.length;t++){if(d[t].frame==u){N.append('<div class="hotspot" id="hs'+t+'"></div>');N.find("#hs"+t+"").css({top:d[t].posiy+"%",left:d[t].posix+"%"}).fadeIn(50);if(d[t].posix>60){N.find("#hs"+t+"").addClass("posr")}if(d[t].posiy>75){N.find("#hs"+t+"").addClass("posb")}}}if(e!==undefined){rt(e)}p=false}function nt(){N.find(".highlights_item").removeClass("active");N.find(".hotspot").fadeOut(50,function(){e(this).remove()});p=true}function rt(e){if(e!==undefined){N.find(".highlights_item").removeClass("active");N.find('.highlights_item[href="'+e+'"]').addClass("active");N.find("#hs"+e+"").addClass("expanded").append('<span class="hltitle">'+d[e].title+"</span>");if(d[e].text){if(N.find("#hs"+e+"").is(".posb")){N.find("#hs"+e+"").prepend('<span class="hltext">'+d[e].text+"</span>")}else{N.find("#hs"+e+"").append('<span class="hltext">'+d[e].text+"</span>")}}if(N.find("#hs"+e+"").is(".posr")){var t=N.find("#hs"+e+"").position();N.find("#hs"+e+"").css({left:"0px"});var n=N.find("#hs"+e+"").outerWidth();var r=t.left-n+20;N.find("#hs"+e+"").css({left:r+"px"})}if(N.find("#hs"+e+"").is(".posb")){var t=N.find("#hs"+e+"").position();N.find("#hs"+e+"").css({top:"0px"});var i=N.find("#hs"+e+"").outerHeight();var r=t.top-i+20;N.find("#hs"+e+"").css({top:r+"px"})}}}function it(){N.find(".expanded").each(function(){var t=parseInt(e(this).attr("id").replace("hs",""));N.find(".expanded").css({top:d[t].posiy+"%",left:d[t].posix+"%"}).removeClass("expanded").find(".hltitle,.hltext").remove()})}}var lt;var ct;if(!t){N.on("mousedown.initrotate",function(e){if(!Y){var t=e.pageX-A.left;ot(t)}});N.find(".zoom").on("click.initzoom",function(e){var t=N.offset();var n=e.pageX-t.left;var r=e.pageY-t.top;at(n,r,t)})}if(t){N.on("touchstart.initrotatemob",function(e){if(!Y){e.preventDefault();var t=window.event;var n=t.touches[0].pageX-A.left;ut(n)}});N.find(".zoom").on("touchstart.initzoommob",function(e){e.preventDefault();var t=N.offset();ht(t)})}}})(jQuery)